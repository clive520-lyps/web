<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鹿陽活動相簿</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #f4f4f9;
            color: #333;
        }

        .container {
            max-width: 900px; /* 增加寬度以容納兩欄 */
            margin: 50px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        /* 標題區塊 */
        .header {
            border-bottom: 2px solid #e1b452;
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        
        h1 {
            color: #5a5a5a;
            font-size: 1.8em;
            margin: 0;
        }

        /* 模擬圖片中的建築裝飾 */
        .decoration {
            width: 100px;
            height: 30px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 30"><path fill="%23e1b452" d="M 0 30 L 0 10 Q 5 0, 10 10 T 20 10 T 30 10 T 40 10 T 50 10 T 60 10 T 70 10 T 80 10 T 90 10 L 100 0 L 100 30 Z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        /* 連結容器 - 桌面模式 (5行 x 2欄) */
        #link-list {
            position: relative;
            overflow: hidden; /* 隱藏未顯示的頁面 */
            height: 380px; /* 調整高度以確保 5 行內容不會被截斷 (修復高度不足問題) */
        }
        
        .page-container {
            width: 100%;
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        
        .link-page {
            min-width: 100%; /* 確保每頁佔滿容器 */
            box-sizing: border-box;
            padding: 0 10px;
        }

        /* 網格佈局：兩欄，每欄五個 */
        .link-grid {
            list-style-type: none;
            padding: 0;
            display: grid;
            grid-template-columns: 1fr 1fr; /* 兩欄 */
            gap: 15px 30px; /* 行間距和欄間距 */
        }

        li {
            padding: 15px 12px; /* 增加垂直間距 */
            background-color: #fff8e8; /* 類似圖片中的淺黃背景 */
            display: flex;
            align-items: center;
            border-bottom: 1px solid #fff8e8; /* 隱藏底線，讓項目看起來更獨立 */
        }

        li:hover {
            background-color: #ffe6b0; /* Hover 效果 */
            transition: background-color 0.3s;
        }

        .link-icon {
            margin-right: 15px;
            color: #e1b452; /* 模擬黃色三角形 */
            font-size: 1.2em;
        }
        
        a {
            text-decoration: none;
            color: #333; /* 連結顏色 */
            font-size: 1em;
            flex-grow: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        a:hover {
            text-decoration: none;
            color: #007bff;
        }

        a:visited {
            color: #333;
        }
        
        #loading {
            font-size: 1.2em;
            color: #888;
            text-align: center;
            padding: 50px;
        }
        
        /* 翻頁控制項 */
        .pagination-controls {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            pointer-events: none; /* 讓箭頭可以點擊 */
            transform: translateY(-50%);
        }
        
        .arrow {
            font-size: 2.5em;
            color: #e1b452;
            cursor: pointer;
            padding: 0 5px;
            pointer-events: auto; /* 啟用點擊 */
            user-select: none;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .arrow:hover:not(.disabled) {
            opacity: 1;
        }
        
        .arrow.disabled {
            color: #ccc;
            cursor: default;
            opacity: 0.3;
        }

        /* 頁碼點點 */
        .page-dots {
            text-align: center;
            margin-top: 15px;
        }
        
        .dot {
            height: 10px;
            width: 10px;
            margin: 0 4px;
            background-color: #ddd;
            border-radius: 50%;
            display: inline-block;
            transition: background-color 0.3s;
        }
        
        .dot.active {
            background-color: #e1b452;
        }


        /* ======================================= */
        /* RWD Media Query: 響應式網頁設計 */
        /* ======================================= */
        @media (max-width: 600px) {
            .container {
                max-width: 100%; /* 佔滿螢幕寬度 */
                margin: 20px 10px; /* 縮小邊距 */
                padding: 15px;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .decoration {
                display: none; /* 在手機上隱藏裝飾以節省空間 */
            }

            /* 連結容器改為單欄 (10個項目垂直堆疊) */
            .link-grid {
                grid-template-columns: 1fr; /* 單欄顯示 */
                gap: 0; /* 移除間距 */
            }
            
            /* 調整列表高度以容納 10 個項目堆疊 */
            #link-list {
                height: 550px; /* 調整高度以容納 10 個項目堆疊 */
            }

            li {
                padding: 12px 10px;
                background-color: #fff8e8;
                border-bottom: 1px solid #e9e9e9; /* 在單欄模式下使用分隔線 */
            }
            
            li:last-child {
                border-bottom: none;
            }
            
            /* 翻頁箭頭調整 */
            .arrow {
                font-size: 2em;
                padding: 0 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>鹿陽活動相簿</h1>
            <div class="decoration"></div>
        </div>
        
        <div id="loading">讀取中...</div>
        
        <div id="link-list">
            <div class="page-container" id="page-container">
                </div>
            
            <div class="pagination-controls">
                <span id="prev-btn" class="arrow disabled" onclick="changePage(-1)">&lt;</span>
                <span id="next-btn" class="arrow" onclick="changePage(1)">&gt;</span>
            </div>
        </div>
        
        <div class="page-dots" id="page-dots">
            </div>

    </div>

    <script>
        // **重要：將此 URL 替換為您部署 Apps Script 網頁應用程式後的 URL**
        // 使用您在原檔案中提供的範例 URL
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxj8-L4N7lhnYcqbgLiEdWBbg7s_Saoxe-fZaQXpTB7_YYq3qKl_zCuFz-Lk4aBMdBvkQ/exec'; 

        const pageContainer = document.getElementById('page-container');
        const loadingMessage = document.getElementById('loading');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const pageDots = document.getElementById('page-dots');
        
        const LINKS_PER_PAGE = 10; // 每頁顯示 10 個連結 (5 行 x 2 欄)
        let allData = [];
        let currentPage = 0;
        let totalPages = 0;

        // 繪製單一頁面的連結
        function renderPage(pageIndex) {
            const start = pageIndex * LINKS_PER_PAGE;
            const end = start + LINKS_PER_PAGE;
            const pageData = allData.slice(start, end);
            
            const pageDiv = document.createElement('div');
            pageDiv.classList.add('link-page');

            const linkGrid = document.createElement('ul');
            linkGrid.classList.add('link-grid');
            
            pageData.forEach(row => {
                const index = row[0]; // 序號
                const name = row[1];  // 相簿名稱
                let url = row[2];     // 相簿網址

                if (name && url) {
                    // 如果網址不是以 https:// 或 http:// 開頭，則自動加上 https://
                    if (typeof url === 'string' && !url.match(/^https?:\/\//)) {
                        url = 'https://' + url;
                    }

                    const listItem = document.createElement('li');
                    // 使用三角形圖標代替序號
                    listItem.innerHTML = `<span class="link-icon">▶</span> <a href="${url}" target="_blank" title="${name}(另開新視窗)">${name}</a>`;
                    linkGrid.appendChild(listItem);
                }
            });
            
            pageDiv.appendChild(linkGrid);
            pageContainer.appendChild(pageDiv);
        }

        // 更新翻頁按鈕和頁碼點點的狀態
        function updateControls() {
            prevBtn.classList.toggle('disabled', currentPage === 0);
            nextBtn.classList.toggle('disabled', currentPage === totalPages - 1 || totalPages === 0);

            // 更新頁碼點點
            pageDots.innerHTML = '';
            for (let i = 0; i < totalPages; i++) {
                const dot = document.createElement('span');
                dot.classList.add('dot');
                if (i === currentPage) {
                    dot.classList.add('active');
                }
                dot.onclick = () => goToPage(i);
                pageDots.appendChild(dot);
            }
        }

        // 切換頁面
        function goToPage(pageIndex) {
            if (pageIndex < 0 || pageIndex >= totalPages) return;
            
            currentPage = pageIndex;
            const offset = -currentPage * 100; // 100% 偏移
            pageContainer.style.transform = `translateX(${offset}%)`;
            updateControls();
        }

        // 左右翻頁 (增減頁碼)
        function changePage(delta) {
            goToPage(currentPage + delta);
        }

        // 主要資料讀取函數
        function fetchAndRenderLinks() {
            if (APPS_SCRIPT_URL.includes('YOUR_APPS_SCRIPT_WEB_APP_URL_HERE')) {
                loadingMessage.textContent = '請在程式碼中替換 Apps Script 的 URL。';
                return;
            }

            fetch(APPS_SCRIPT_URL)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('網路回應有問題');
                    }
                    return response.json();
                })
                .then(data => {
                    loadingMessage.style.display = 'none'; // 隱藏讀取訊息
                    
                    // 過濾掉無效資料，並確保只有有相簿名稱和網址的項目被計算
                    allData = data.filter(row => row[1] && row[2]);
                    
                    if (allData.length === 0) {
                        loadingMessage.style.display = 'block';
                        loadingMessage.textContent = '試算表中沒有資料。';
                        return;
                    }

                    // 計算總頁數
                    totalPages = Math.ceil(allData.length / LINKS_PER_PAGE);

                    // 循環資料並生成所有頁面
                    for (let i = 0; i < totalPages; i++) {
                        renderPage(i);
                    }
                    
                    // 顯示第一頁並更新控制項
                    goToPage(0);

                })
                .catch(error => {
                    loadingMessage.style.display = 'block';
                    loadingMessage.textContent = '讀取資料時發生錯誤：' + error.message;
                    console.error('Fetch Error:', error);
                });
        }
        
        fetchAndRenderLinks();
    </script>
    
    <a href="https://docs.google.com/spreadsheets/d/15zqf581Gj_hEy9Kr3Tlgcsw-_C8jIBnaOf2OSBJzD2s/edit?usp=sharing" target="_blank" style="display:block; text-align:center; margin-top: 20px; font-size: 1.1em; color: #5a5a5a; text-decoration: none;">編輯活動相簿資料</a>
    
</body>
</html>